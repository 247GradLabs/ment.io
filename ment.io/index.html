<!DOCTYPE html>
<html ng-app="mentio-demo">
<head>
    <meta charset="utf-8" />
    <title>{{title}}</title>
    <link data-require="bootstrap-css@3.1.1" data-semver="3.1.1" rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" />
    <link rel="stylesheet" href="styles.css" />
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.18/angular.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.18/angular-route.min.js"></script>
    <script src="../dist/mentio.js"></script>
    <script src="scripts.js"></script>
</head>
<body ng-controller="mentio-demo-ctrl">
<div>
    <nav class="navbar navbar-default" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" ng-href="#">ment.io</a>
                <ul class="nav navbar-nav">
                    <li ng-class="{active: tab === 'examples' }"><a ng-href="#/examples">Demo</a></li>
                    <li ng-class="{active: tab === 'documentation' }"><a ng-href="#/documentation">Documentation</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div ng-view></div>

    <script type="text/ng-template" id="examples.html">
        <div class="container">
            <div class="row">
                <header class="text-center">
                    <h1 class="heading">Ment.io</h1>
                    <h6 class="text-muted">(Angular @mentions with macros)</h6>
                </header>
            </div>
            <div class="row">
                <div class="col-md-12">

                    <div class="form-group">
                        <h3>Content Editable:</h3>
                        <div class="editor form-control" contenteditable ng-model="htmlContent">
                            Try me @
                            <br>
                            or add a macro like brb, omw, (smile)
                        </div>
                        <span class="caption small">Mentioned: {{atVar}}</span>
                    </div>

                    <mentio-menu bind="htmlContent" ng-model="atVar" macros="macros" ng-cloak>
                        <mentio-rule trigger-char="@" items="people" template="/people-mentions.tpl"
                                     search="searchPeople(term)" select="getPeopleText(item)"></mentio-rule>
                        <mentio-rule trigger-char="#" items="products" template="/product-mentions.tpl"
                                     search="searchProducts(term)" select="getProductText(item)"></mentio-rule>
                    </mentio-menu>

                    <div class="form-group">
                        <h3>Text Area:</h3>
                        <textarea class="form-control" ng-model="theTextArea" ng-trim="false" class="editor" rows="6"></textarea>
                        <span class="caption small">Mentioned: {{atVar2}}</span>
                    </div>

                    <mentio-menu bind="theTextArea" ng-model="atVar2" macros="macros" ng-cloak>
                        <mentio-rule trigger-char="@" items="people" template="/people-mentions.tpl"
                                     search="searchPeople(term)" select="getPeopleTextRaw(item)"></mentio-rule>
                        <mentio-rule trigger-char="#" items="products" template="/product-mentions.tpl"
                                     search="searchProducts(term)" select="getProductTextRaw(item)"></mentio-rule>
                    </mentio-menu>

                    <div class="form-group">
                        <h3>Text Area:</h3>
                        <input type="text" class="form-control" ng-model="theText" ng-trim="false" size="100"/>
                        <span class="caption small">Mentioned: {{atVar3}}</span>
                    </div>

                    <mentio-menu bind="theText" ng-model="atVar3" ng-cloak>
                        <mentio-rule trigger-char="@" items="people" template="/people-mentions.tpl"
                                     search="searchPeople(term)" select="getPeopleTextRaw(item)"></mentio-rule>
                        <mentio-rule trigger-char="#" items="products" template="/product-mentions.tpl"
                                     search="searchProducts(term)" select="getProductTextRaw(item)"></mentio-rule>
                    </mentio-menu>
                </div>
            </div>
        </div>
    </script>

    <script type="text/ng-template" id="documentation.html">
        <div class="container">
            <div class="row">
                <h3 class="heading">Basic Concepts</h3>
                The <code>mentio-menu</code> tag  attaches to a single text element on a page through
                an ngModel name reference.  The mentio-menu effectively watches the <code>$viewValue</code> of the targeted element and 
                responds to changes with "@mentions" functionality and macro replacement.
                <h3 class="heading">Elements</h3>
                <header class="documentation-element">
                    <code>
                    mentio-menu
                    </code>
                </header>
                <p>The <code>mentio-menu</code> element wraps a set of <code>menio-rule</code> elements that specify which characters to 
                trigger on for typeahead selection.  A translation table to use for macros is also specified in the <code>macros</code> attribute. 
                </p>
                <h4 class="heading">Attributes</h4>
 
                <header class="text-primary documentation-attr">bind</header>
                Specifies the name of an ngModel on another text element to attach to.  This will cause the menu to watch the other 
                element for changes and display if a proper sequence of characters is entered.  The following rules are applied when
                matching a well-formed mention:
                <ul>
                    <li>A registered trigger character is present in the text preceding the current caret location</li>
                    <li>A space precedes the trigger character</li>
                    <li>The text following the trigger character contains no spaces up to the current caret location</li>
                </ul>
                When a match is found, the current text after the trigger character is set as the $viewValue of the <code>mentio-menu</code>.  
                It is only possible for one trigger character to be active at a time.  Also, only one menu will display on a given page
                at a time.  

                <header class="text-primary documentation-attr">ng-model</header>
                Gives the ngModel name for the mentioned text after a triggerchar in the target text control.  This
                can be used to highlight the searched term in the menu that is displayed.

                <header class="text-primary documentation-attr">macros</header>
                Specifies a JSON map of macro translations.  The key should be a simple sequence of characters, not including spaces.  The key 
                will be matched case-insensitive.  When a match is detected, the value in the macro table will be expanded in place of the 
                macro the user typed.
                <p></p>
                An example from the sample demo in <code>scripts.js</code>:
                <p></p>
                <pre>
                    $scope.macros = {
                        'brb': 'Be right back',
                        'omw': 'On my way',
                        '(smile)' : '&lt;img src="http://a248.e.akamai.net/assets.github.com/images/icons/emoji/smile.png"' +
                                ' height="20" width="20"&gt;'
                    };</pre>

                <header class="documentation-element">
                    <code>
                    mentio-rule
                    </code>
                </header>
                <p>The <code>mentio-rule</code> element specifies the behavior for each desired trigger character that the <code>mentio-menu</code>
                should respond to.  Each rule must specify the trigger character, a data collection, the template to use to render the menu, a search 
                function, and a select function.  Based on the specified attributes, the specified behavior will happen whenever text in the target
                text element is changed.  </p>
                <h4 class="heading">Attributes</h4>
 
                <header class="text-primary documentation-attr">trigger-char</header>
                The character that should trigger the menu behavior.  In the example, @ and # are used.

                <header class="text-primary documentation-attr">items</header>
                The data list to bind the menu to.  This must be a reference to a value in current scope.  Since a <code>mentio-menu</code> has
                isolate scope, the list referenced by the <code>items</code> attribute will
                be passed down through the child scope contexts to the template used in the <code>mention-rule</code>, which then allows it to
                be refrenced in an angular expression that drives an <code>ng-repeat</code>.  Note the reference to <code>items</code> in 
                the example below.
                <pre>
                &lt;mentio-rule trigger-char="@" items="people" template="<b>/people-mentions.tpl</b>"
                             search="searchPeople(term)" select="getPeopleTextRaw(item)"&gt&lt;/mentio-rule&gt

                &lt;script type="text/ng-template" id="<b>/people-mentions.tpl</b>"&gt;
                        &lt;ul class="list-group user-search"&gt;
                            &lt;i mentio-menu-item="person" ng-repeat="person in <b>items</b>" class="list-group-item"&gt;
                                &lt;mg ng-src="{{person._source.imageUrl}}" class="user-photo"&gt;
                                &lt;span class="text-primary" 
                                    ng-bind-html="person._source.name | mentioHighlight:atVar:'menu-highlighted' | unsafe">&lt;/span&gt;
                                &lt;em class="text-muted" ng-bind="person._source.bio | words:5">&lt;/em&gt;
                            &lt;/li&gt;
                        &lt;/ul&gt;
                    &lt;/script&gt;</pre>

                <header class="text-primary documentation-attr">template</header>
                Specifies the id of a template to use to render the select menu.  The template should iterate the <code>items</code> list to
                present a menu of choices.  The <code>ng-model</code> form the <code>mentio-menu</code> itself can be accessed in order
                to highlight text in the menu.

                <h3 class="heading">Filters</h3>
                <header class="documentation-element">
                    <code>
                    mentionHighlight
                    </code>
                </header>
               <p></p>
           </div>
        </div>
    </script>

    <script type="text/ng-template" id="/product-mentions.tpl">
        <ul class="list-group product-search">
            <li mentio-menu-item="product" ng-repeat="product in items" class="list-group-item clearfix">
                <div class="row">
                    <div class="col-xs-2 text-center">
                        <img ng-src="{{product._source.imageUrl}}" class="product-photo">
                    </div>
                    <div class="col-xs-10">
                        <h4 class="list-group-item-heading">{{product._source.title | words:5}}</h4>
                        <p class="list-group-item-text">{{product._source.description | words:7}}</p>
                    </div>
                </div>
            </li>
        </ul>
    </script>

    <script type="text/ng-template" id="/people-mentions.tpl">
        <ul class="list-group user-search">
            <li mentio-menu-item="person" ng-repeat="person in items" class="list-group-item">
                <img ng-src="{{person._source.imageUrl}}" class="user-photo">
                <span class="text-primary" ng-bind-html="person._source.name | mentioHighlight:atVar:'menu-highlighted' | unsafe"></span>
                <em class="text-muted" ng-bind="person._source.bio | words:5"></em>
            </li>
        </ul>
    </script>

    <a href="https://github.com/jeff-collins/ment.io"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>

    </div>
</body>

</html>
